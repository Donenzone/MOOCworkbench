{% extends "experiments_table.html" %}
{% load bootstrap %}

{% block content %}
Status: {{ status }}

<div class="output" style="font-family: Courier New; background-color: black; color: green;padding-left: 10px;font-weight: bold;"></div>

<script>
    $(function () {
        // Correctly decide between ws:// and wss://
        var ws_scheme = window.location.protocol == "https:" ? "wss" : "ws";
        var ws_path = ws_scheme + '://' + window.location.host + window.location.pathname + "worker/";
        console.log("Connecting to " + ws_path);
        var socket = new WebSocket(ws_path);
        // Handle incoming messages
        socket.onmessage = function(message) {
            var data = JSON.parse(message.data);
            // Create the inner content of the post div
            $('.output').append("<p>" + data.text + "</p>")
        };
        // Helpful debugging
        socket.onopen = function() { console.log("Connected to notification socket"); }
        socket.onclose = function() { console.log("Disconnected to notification socket"); }
    });
</script>

{% endblock %}
