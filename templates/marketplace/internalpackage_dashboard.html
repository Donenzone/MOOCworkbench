{% extends 'marketplace/internalpackage_detail.html' %}
{% load django_bootstrap_breadcrumbs %}
{% load bootstrap %}
{% load comments %}

{% block breadcrumbs %}
    {{ block.super }}
    {% breadcrumb 'Dashboard' "internalpackage_dashboard" object.id %}
{% endblock %}

{% block content %}
    <h2>{{ object.package_name }}</h2>

    <h3>Settings</h3>
    <form action="{% url 'internalpackage_update' object.id %}" method="post">
        {% csrf_token %}
        {{ edit_form|bootstrap }}
        <button class="btn btn-primary" value="Save">Save changes</button>
    </form>

    <h3>Workbench services</h3>
    <div id="requirements">
        Loading...
    </div>

    <div id="ci">
        Loading...
    </div>

    <div id="docs">
        Loading...
    </div>


    <script type="text/javascript">
        $(document).ready(function() {
            url_dict = {
              'requirements': "{% url 'requirements_list' object.id object_type %}",
              'readme': "{% url 'readme_view' object.id %}",
              'ci': "{% url 'build_status' object.id object_type %}",
              'docs': "{% url 'docs_status' object.id object_type %}",
            };

            $("#requirements").load(url_dict['requirements']);
            $("#ci").load(url_dict['ci']);
            $("#docs").load(url_dict['docs']);
        })
    </script>
{% endblock %}